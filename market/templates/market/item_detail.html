{% extends "market/base.html" %}
{% block content %}
  <div class="card">
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:30px;align-items:start;">
      <div>
        {% if item.image %}
          <img src="{{ item.image.url }}" alt="{{ item.title }}" style="width:100%;border-radius:15px;box-shadow:0 8px 32px rgba(0,0,0,0.1);" />
        {% else %}
          <div style="width:100%;height:300px;background:linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);border-radius:15px;display:flex;align-items:center;justify-content:center;color:#a0aec0;font-size:72px;">
            {% if item.category == 'evening_dress' %}👗
            {% elif item.category == 'game_console' %}🎮
            {% elif item.category == 'game_disc' %}💿
            {% elif item.category == 'toy' %}🧸
            {% elif item.category == 'book' %}📚
            {% else %}🎁
            {% endif %}
          </div>
        {% endif %}
      </div>
      
      <div>
        <h1 style="margin:0 0 16px 0;color:#2d3748;">{{ item.title }}</h1>
        <div style="background:#f7fafc;padding:16px;border-radius:12px;margin-bottom:20px;">
          <p style="margin:0;color:#4a5568;line-height:1.6;">{{ item.description|default:"Açıklama eklenmemiş." }}</p>
        </div>
        
        <div style="display:flex;align-items:center;margin-bottom:20px;">
          <span style="color:#667eea;font-weight:600;">👤 Sahibi:</span>
          <a href="{% url 'market:user_profile' item.owner.username %}" style="margin-left:8px;font-weight:600;color:#2d3748;text-decoration:none;">{{ item.owner.first_name|default:item.owner.username }}</a>
        </div>
        
        <div style="background:linear-gradient(135deg, #667eea15 0%, #764ba215 100%);padding:16px;border-radius:12px;margin-bottom:20px;">
          <span style="color:#667eea;font-weight:600;">🏷️ Kategori:</span>
          <span style="margin-left:8px;">{{ item.get_category_display }}</span>
        </div>
        
        {% if request.user.is_authenticated and request.user != item.owner %}
          <div style="display:flex;gap:12px;margin-bottom:20px;">
            <a href="{% url 'market:toggle_favorite' item.id %}" class="btn outline" style="
              {% if is_favorited %}
                background:#e53e3e;color:white;border-color:#e53e3e;
              {% else %}
                border-color:#e53e3e;color:#e53e3e;
              {% endif %}
            ">
              {% if is_favorited %}❤️ Favorilerden Çıkar{% else %}🤍 Favorilere Ekle{% endif %}
            </a>
          </div>
        {% endif %}
        
        {% if trade_form %}
          <div style="background:#f0fff4;border:2px solid #68d391;border-radius:15px;padding:24px;">
            <h3 style="color:#2f855a;margin:0 0 16px 0;">🔄 Takas Teklifi Ver</h3>
            <form method="post" action="{% url 'market:trade_create' item.id %}">
              {% csrf_token %}
              {{ trade_form.as_p }}
              <button class="btn" type="submit" style="background:linear-gradient(135deg, #48bb78 0%, #38a169 100%);">✨ Teklif Gönder</button>
            </form>
          </div>
        {% elif request.user == item.owner %}
          <div style="background:#fef5e7;border:2px solid #ed8936;border-radius:15px;padding:24px;text-align:center;">
            <p style="color:#c05621;margin:0;font-weight:600;">📝 Bu sizin ürününüz</p>
          </div>
        {% elif not request.user.is_authenticated %}
          <div style="background:#ebf8ff;border:2px solid #3182ce;border-radius:15px;padding:24px;text-align:center;">
            <p style="color:#2c5282;margin:0 0 16px 0;font-weight:600;">🔐 Takas teklifinde bulunmak için giriş yapın</p>
            <a href="{% url 'login' %}" class="btn">Giriş Yap</a>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
  
  <div style="text-align:center;margin-top:20px;">
    <a href="{% url 'market:index' %}" class="btn outline">← Tüm Ürünlere Dön</a>
  </div>
{% endblock %}
